<template>
  <div>
    <Navigation></Navigation>
    <section
      id="titlePicture"
    >PUT THE ARTICLE PICTURE HERE AS A BACKGROUND, AND ATTACH WITH SOME LINES OF TEXT AS ARTICLE BRIEF.</section>
    <ShareSocial></ShareSocial>
    <div id="printArea">
      <section id="authorHeading">
        <div>
          <img src="../assets/head.png" alt="avatar not available" />
        </div>
        <p class="p1">Author Name</p>
        <p class="p2">5 mins read</p>
      </section>
      <section id="articleBody">
        <h1>{{$route.params.essayTitle}}</h1>
        <p>
          Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article
          text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this
          is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text.
          Sample blog article text, this is some text. Sample blog article text, this is some text.
        </p>
        <br />
        <h3>Sample Blog Article Sub Title 1</h3>
        <p>
          Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article
          text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this
          is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text.
          Sample blog article text, this is some text. Sample blog article text, this is some text.
        </p>
        <br />
        <h3>Sample Blog Article Sub Title 1</h3>
        <p>
          Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article
          text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this
          is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text.
          Sample blog article text, this is some text. Sample blog article text, this is some text.
        </p>
        <br />
        <h3>Sample Blog Article Sub Title 1</h3>
        <p>
          Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article
          text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this
          is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text.
          Sample blog article text, this is some text. Sample blog article text, this is some text.
        </p>
        <br />
        <h3>Sample Blog Article Sub Title 1</h3>
        <p>
          Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article
          text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this
          is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text.
          Sample blog article text, this is some text. Sample blog article text, this is some text.
        </p>
        <br />
        <h3>Sample Blog Article Sub Title 1</h3>
        <p>
          Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article
          text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this
          is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text.
          Sample blog article text, this is some text. Sample blog article text, this is some text.
        </p>
        <br />
        <h3>Sample Blog Article Sub Title 1</h3>
        <p>
          Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article
          text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this
          is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text.
          Sample blog article text, this is some text. Sample blog article text, this is some text.
        </p>
        <br />
        <h3>Sample Blog Article Sub Title 1</h3>
        <p>
          Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article
          text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this
          is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text.
          Sample blog article text, this is some text. Sample blog article text, this is some text.
        </p>
        <br />
        <h3>Sample Blog Article Sub Title 1</h3>
        <p>
          Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article
          text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this
          is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text. Sample blog article text, this is some text.
          Sample blog article text, this is some text. Sample blog article text, this is some text.
        </p>
        <br />
      </section>
      <section id="tagArea">
        <div class="articleTag" v-for="tag in articleTag" v-bind:key="tag">{{tag}}</div>
      </section>
      <hr class="divider" />
      <section id="authorBio">
        <div id="authorAvatar">
          <img src="../assets/head.png" alt="avatar not available" />
        </div>
        <div id="authorName">Author Name</div>
        <div id="authorIntro">Some introduction of the author, background, career, and etc...</div>
      </section>
      <hr class="divider" />
      <section id="commentArea">
        <div id="commentAdd">
          <div class="nameArea">
            <div>
              <img src="../assets/head.png" alt="avatar not available" />
            </div>
            <div>Reader Name</div>
            <button v-on:click="publishComment">Publish</button>
          </div>
          <textarea id="contentArea" placeholder="please leave a comment" v-model="userInput"></textarea>
        </div>

        <div
          id="commentListTrigger"
          v-on:click="listTrigger"
        >{{triggerText}} ({{articleCommentList().length}})</div>

        <ul id="commentList" v-show="showCommentList">
          <li v-for="(userComment, index) in articleCommentList()" v-bind:key="index">
            <div class="commentBox">
              <div class="nameArea">
                <div>
                  <img src="../assets/head.png" alt="avatar not available" />
                </div>
                <div>{{userComment.readerName}}</div>
                <div>{{userComment.threadTime}}</div>
              </div>
              <div class="thread">{{userComment.content}}</div>
              <div class="interactBtns">
                <div class="shareNumber">{{userComment.shares}}</div>
                <div class="share" v-on:click="doShare(index, false, undefined)"></div>
                <div class="replyNumber">{{userComment.replies}}</div>
                <div class="reply" v-on:click="doReply(index, undefined, userComment.readerName)"></div>
                <div class="likeNumber">{{userComment.likes}}</div>
                <div class="like" v-on:click="doLike(index, false, undefined)"></div>
              </div>
            </div>
            <ul class="replyBox">
              <li class="replyItem" v-for="(r, i) in userComment.replyItems" v-bind:key="i">
                <div class="nameArea">
                  <div>
                    <img src="../assets/head.png" alt="avatar not available" />
                  </div>
                  <div>{{r.readerName}}</div>
                  <div>{{r.threadTime}}</div>
                </div>
                <div class="thread">{{r.content}}</div>
                <div class="interactBtns">
                  <div class="shareNumber">{{r.shares}}</div>
                  <div class="share" v-on:click="doShare(index, true, i)"></div>
                  <div class="replyNumber">{{r.replies}}</div>
                  <div class="reply" v-on:click="doReply(index, i, r.readerName)"></div>
                  <div class="likeNumber">{{r.likes}}</div>
                  <div class="like" v-on:click="doLike(index, true, i)"></div>
                </div>
              </li>
            </ul>
          </li>
        </ul>
      </section>
    </div>

    <ReplyModal v-bind:_showReplyModal="modalVal" v-on:changeModalVal="modalValHandler"></ReplyModal>

    <hr class="customHr" />

    <section id="recommendations">
      <h2>More From Torneo</h2>
      <ul id="recommendList">
        <li class="recommendItem" v-for="(articleId, index) in recommendedIndex" v-bind:key="index">
          <div class="recommendTitle">{{essays[articleId].essayTitle}}</div>
          <div class="recommendBrief">
            <a href="#">{{essays[articleId].aLinkText}}</a>
          </div>
          <div class="authorBox">
            <div class="authorAvatarBox">
              <img v-bind:src="essays[articleId].headImgSrc" alt="avatar not available" />
            </div>
            <div class="infoBox">
              <div class="nameBox">{{essays[articleId].author}}</div>
              <div class="timeBox">{{essays[articleId].essayLength}}, {{essays[articleId].dateInfo}}</div>
            </div>
          </div>
        </li>
      </ul>
    </section>

    <GoTop></GoTop>
    <Footer></Footer>
  </div>
</template>

<script>
import GoTop from "../components/GoTop";
import Navigation from "../components/Navigation";
import ShareSocial from "../components/ShareSocial";
import Footer from "../components/Footer";
import ReplyModal from "../components/ReplyModal";
import { mapState } from "vuex";
export default {
  name: "Read",
  components: {
    Navigation,
    ShareSocial,
    Footer,
    GoTop,
    ReplyModal
  },
  data() {
    return {
      userInput: "",
      showCommentList: false,
      triggerText: "Click to See All Responses",
      modalVal: false
    };
  },
  computed: {
    ...mapState(["essays", "recommendedIndex"]),
    articleTag() {
      let tags = [];
      let articleTitle = this.$route.params.essayTitle;
      for (let i = 0; i < this.essays.length; i++) {
        if (this.essays[i].essayTitle === articleTitle) {
          tags = this.essays[i].tags;
          break;
        }
      }
      return tags;
    }
  },
  methods: {
    articleCommentList() {
      for (let i = 0; i < this.essays.length; i++) {
        if (this.essays[i].essayTitle === this.$route.params.essayTitle) {
          return this.essays[i].commentList;
        }
      }
    },
    getSystemTime() {
      let d = new Date();
      let day = d.getDate();
      let month = d.getMonth() + 1;
      let year = d.getFullYear();
      let hour = d.getHours();
      let minute = d.getMinutes();
      let section = "";
      if (hour >= 0 && hour <= 11) {
        section = "AM";
      } else {
        section = "PM";
      }
      let mutatedHour = hour >= 0 && hour <= 11 ? hour : hour - 12;
      let mutatedMonth = "";
      switch (month) {
        case 1:
          mutatedMonth = "January";
          break;
        case 2:
          mutatedMonth = "February";
          break;
        case 3:
          mutatedMonth = "March";
          break;
        case 4:
          mutatedMonth = "April";
          break;
        case 5:
          mutatedMonth = "May";
          break;
        case 6:
          mutatedMonth = "June";
          break;
        case 7:
          mutatedMonth = "July";
          break;
        case 8:
          mutatedMonth = "August";
          break;
        case 9:
          mutatedMonth = "September";
          break;
        case 10:
          mutatedMonth = "October";
          break;
        case 11:
          mutatedMonth = "November";
          break;
        case 12:
          mutatedMonth = "December";
          break;
        default:
          break;
      }

      // i.e. August 01, 2019, 4:30PM
      let timeStr =
        mutatedMonth +
        " " +
        day +
        ", " +
        year +
        ", " +
        mutatedHour +
        ":" +
        minute +
        section;

      return timeStr;
    },
    publishComment() {
      if (this.userInput === "") {
        return;
      }
      let payload = {
        essayTitle: this.$route.params.essayTitle,
        comment: {
          readerName: "User Name X",
          threadTime: this.getSystemTime(),
          content: this.userInput,
          likes: 0,
          replies: 0,
          shares: 0,
          replyItems: []
        }
      };
      this.$store.commit("addComment", payload);
      this.userInput = "";
    },
    doShare(index, deepVal, subIndex) {
      // some backend logic here...
      console.log("This comment tread has been shared!");
      let payload = {
        essayTitle: this.$route.params.essayTitle,
        index: index,
        category: "shares",
        deep: deepVal,
        subIndex: subIndex
      };
      this.$store.commit("increaseSum", payload);
    },
    doLike(index, deepVal, subIndex) {
      let payload = {
        essayTitle: this.$route.params.essayTitle,
        index: index,
        category: "likes",
        deep: deepVal,
        subIndex: subIndex
      };
      this.$store.commit("increaseSum", payload);
    },
    doReply(indexOut, indexIn, replyToName, deepVal) {
      // index is the index outside. i is the index inside.
      this.modalVal = true;
      this.$store.commit("updateModalDataTemp", {
        essayTitle: this.$route.params.essayTitle,
        index: indexOut,
        replyToName: replyToName,
        deepVal: deepVal,
        subIndex: indexOut
      });
    },
    listTrigger() {
      this.showCommentList = !this.showCommentList;
      if (this.showCommentList) {
        this.triggerText = "Click to Hide All Responses";
      } else {
        this.triggerText = "Click to See All Responses";
      }
    },
    modalValHandler(val) {
      this.modalVal = val;
    }
  }
};
</script>

<style scoped>
#titlePicture {
  width: 100%;
  height: 400px;
  /* you can put here a background-image instead of background-color */
  background-color: #0e71a3;
  background-size: cover;
  background-repeat: no-repeat;
  font-family: "Quicksand";
  font-size: 26px;
  text-align: right;
  box-sizing: border-box;
  padding-top: 130px;
  padding-right: 40px;
  padding-left: 400px;
  color: white;
  font-style: oblique;
  overflow: hidden;
  box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.4);
}
#printArea {
  width: 70%;
  position: relative;
  left: 15%;
  top: 0;
  padding: 150px 70px 30px 70px;
  box-sizing: border-box;
  font-family: Quicksand;
}
#authorHeading {
  width: 90%;
  height: 160px;
  position: absolute;
  top: -50px;
  left: 5%;
  text-align: center;
  font-family: "Quicksand";
}
#authorHeading div img {
  height: 100px;
  width: 100px;
  border-radius: 50%;
  box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.4);
}
#authorHeading .p1 {
  font-weight: bold;
  font-size: 20px;
}
#authorHeading .p2 {
  font-size: 16px;
  font-style: oblique;
}
#articleBody {
  width: 100%;
  box-sizing: border-box;
}
#tagArea {
  margin-top: 30px;
  margin-bottom: 20px;
  width: 100%;
  height: 30px;
  line-height: 30px;
  font-family: "Quicksand";
}
#tagArea .articleTag {
  float: right;
  background-color: #363e4f;
  color: white;
  font-weight: bold;
  font-size: 20px;
  padding: 0 15px 0 15px;
  margin-left: 10px;
  margin-bottom: 5px;
  /* border-radius: 15px; */
  box-sizing: border-box;
  box-shadow: 0px 0px 5px 0px rgba(0, 0, 0, 0.2);
  cursor: pointer;
}
#authorBio {
  width: 100%;
  height: 120px;
  box-sizing: border-box;
  margin-bottom: 30px;
  margin-top: 50px;
}
#authorAvatar {
  height: 120px;
  width: 120px;
  float: left;
  box-sizing: border-box;
  padding: 10px 10px 10px 0px;
}
#authorAvatar img {
  width: 100px;
  height: 100px;
  box-sizing: border-box;
  border-radius: 50%;
  box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.4);
}
#authorName {
  height: 40%;
  width: 80%;
  float: left;
  padding-left: 10px;
  line-height: 48px;
  font-family: "Quicksand";
  font-weight: bold;
  font-size: 30px;
}
#authorIntro {
  height: 60%;
  width: 80%;
  float: left;
  padding-left: 10px;
  font-family: "Quicksand";
  font-size: 20px;
  font-style: oblique;
}
.divider {
  height: 0px;
  width: 100%;
  border: none;
  border-bottom: 1px solid gray;
}
#commentArea {
  width: 100%;
  font-family: "Quicksand";
  margin-top: 50px;
}
#commentAdd {
  width: 100%;
  height: 200px;
}
#commentAdd .nameArea {
  width: 100%;
  height: 50px;
}
#commentAdd .nameArea img {
  height: 50px;
  width: 50px;
  border-radius: 50%;
  margin-right: 30px;
  float: left;
}
#commentAdd .nameArea div:nth-child(2) {
  float: left;
  height: 100%;
  width: 300px;
  font-weight: bold;
  font-size: 20px;
  line-height: 50px;
}
#commentAdd .nameArea button {
  height: 100%;
  width: 100px;
  /* border-radius: 25px; */
  font-size: 20px;
  float: right;
  background-color: white;
  cursor: pointer;
  border: none;
  box-shadow: 0 0 5px 0px rgba(0, 0, 0, 0.2);
}
#commentAdd .nameArea button:hover {
  color: #f15b24;
  font-weight: bold;
}
#commentAdd .nameArea button:active {
  color: #f15b24;
  box-shadow: none;
  border: 1px solid rgba(0, 0, 0, 0.2);
}
#commentAdd #contentArea {
  box-sizing: border-box;
  width: 100%;
  height: 150px;
  margin-top: 20px;
  /* border-radius: 10px; */
  font-size: 20px;
  padding: 20px;
  resize: none;
}
#commentAdd #contentArea:focus {
  box-shadow: 0 0 5px 0px rgba(0, 0, 0, 0.2);
  border: 1px solid #363e4f;
}
#commentListTrigger {
  width: 100%;
  height: 40px;
  margin-top: 50px;
  text-align: center;
  font-size: 20px;
  line-height: 40px;
  box-shadow: 0 0 5px 0px rgba(0, 0, 0, 0.2);
  font-style: oblique;
  cursor: pointer;
  user-select: none;
}
#commentListTrigger:hover {
  color: #f15b24;
  font-weight: bold;
}
#commentListTrigger:active {
  box-shadow: none;
  border: 1px solid rgba(0, 0, 0, 0.2);
}
#commentList {
  width: 100%;
  margin-top: 30px;
  position: relative;
}
#commentList .nameArea {
  width: 100%;
  height: 50px;
}
#commentList .nameArea img {
  height: 50px;
  width: 50px;
  border-radius: 50%;
  margin-right: 30px;
  float: left;
}
#commentList .nameArea div:nth-child(2) {
  float: left;
  height: 100%;
  width: 300px;
  font-weight: bold;
  font-size: 20px;
  line-height: 50px;
}
#commentList .nameArea div:nth-child(3) {
  height: 100%;
  width: 250px;
  float: right;
  text-align: right;
  line-height: 50px;
  font-style: oblique;
}
#commentList .thread {
  width: 100%;
  margin-top: 20px;
  box-sizing: border-box;
  font-size: 18px;
}
#commentList .interactBtns {
  width: 100%;
  height: 30px;
  margin-top: 20px;
}
#commentList .interactBtns .like,
#commentList .interactBtns .reply,
#commentList .interactBtns .share {
  float: right;
  width: 40px;
  height: 30px;
  font-size: 20px;
  box-sizing: border-box;
  margin-left: 50px;
  font-family: "icomoon";
  text-align: center;
  line-height: 30px;
  cursor: pointer;
  user-select: none;
}
#commentList .interactBtns .like:hover,
#commentList .interactBtns .reply:hover,
#commentList .interactBtns .share:hover {
  color: #f15b24;
}
#commentList .interactBtns .likeNumber,
#commentList .interactBtns .replyNumber,
#commentList .interactBtns .shareNumber {
  float: right;
  width: 50px;
  height: 30px;
  font-size: 18px;
  box-sizing: border-box;
  font-family: "Quicksand";
  text-align: center;
  line-height: 30px;
}
#commentList .commentBox {
  box-shadow: 0 0 5px 0px rgba(0, 0, 0, 0.2);
  box-sizing: border-box;
  padding: 30px 30px 30px 30px;
  margin-bottom: 10px;
  /* border-radius: 10px; */
}
#commentList .replyBox {
  box-sizing: border-box;
  width: 90%;
  position: relative;
  top: 0px;
  left: 10%;
  margin-bottom: 20px;
}
#commentList .replyBox .replyItem {
  margin-bottom: 10px;
  padding: 20px 30px 20px 30px;
  position: relative;
  box-shadow: 0 0 5px 0px rgba(0, 0, 0, 0.2);
  background-color: whitesmoke;
}
.customHr {
  width: 80%;
  position: relative;
  left: 10%;
}
#recommendations {
  width: 80%;
  position: relative;
  left: 10%;
  font-family: "Quicksand";
  margin-top: 20px;
}
#recommendations h2 {
  font-size: 26px;
  font-style: oblique;
  height: 50px;
  text-decoration: underline;
  box-sizing: border-box;
  padding-left: 10px;
}
#recommendList {
  width: 100%;
  height: 500px;
}
.recommendItem {
  width: 49%;
  height: 230px;
  float: left;
  box-sizing: border-box;
  margin-bottom: 20px;
  box-shadow: 0 0 5px 0px rgba(0, 0, 0, 0.2);
  /* background-image: url("xxxxx"); */
  background-repeat: no-repeat;
  background-size: cover;
  cursor: pointer;
  user-select: none;
  transition-property: all;
  transition-timing-function: ease-in-out;
  transition-duration: 100ms;
}
.recommendItem:hover {
  box-shadow: 0 0 15px 0px rgba(0, 0, 0, 0.3);
}
.recommendItem:active {
  box-shadow: 0 0 5px 0px rgba(0, 0, 0, 0.2);
}
.recommendItem:nth-child(odd) {
  margin-right: 1%;
}
.recommendItem:nth-child(even) {
  margin-left: 1%;
}
.recommendTitle {
  width: 100%;
  height: 72px;
  font-size: 22px;
  font-weight: bold;
  box-sizing: border-box;
  padding: 10px 20px 10px 20px;
  overflow: hidden;
}
.recommendBrief {
  width: 100%;
  height: 72px;
  box-sizing: border-box;
  padding: 10px 20px 10px 20px;
  font-style: oblique;
  overflow: hidden;
  position: relative;
}
.recommendBrief a {
  color: black;
}
.recommendBrief a:hover {
  color: #f15b24;
  font-weight: bold;
}
.authorBox {
  width: 100%;
  height: 72px;
  box-sizing: border-box;
  padding-left: 20px;
}
.authorAvatarBox {
  width: 72px;
  height: 72px;
  float: left;
  box-sizing: border-box;
}
.authorAvatarBox img {
  width: 66px;
  height: 66px;
  margin: 3px auto 3px 0px;
  border-radius: 50%;
  transition-property: all;
  transition-timing-function: ease-in-out;
  transition-duration: 500ms;
}
.recommendItem:hover img {
  transform: rotate(360deg);
}
.infoBox {
  height: 72px;
  padding-left: 10px;
  box-sizing: border-box;
  float: left;
}
.nameBox {
  height: 36px;
  box-sizing: border-box;
  font-weight: bold;
  font-size: 22px;
  line-height: 36px;
}
.timeBox {
  height: 36px;
  box-sizing: border-box;
  font-style: oblique;
  line-height: 36px;
}
</style>



